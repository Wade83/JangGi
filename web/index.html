<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>장기 - 웹 게임</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- User Selection Modal -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <h2 id="user-modal-title">사용자 선택</h2>
            <div id="user-list-section" class="formation-section">
                <div id="user-list" class="user-list"></div>
                <div id="no-user" class="info-line">등록된 사용자가 없습니다.</div>
            </div>
            <button id="show-register-btn" type="button" class="start-btn">새 사용자 등록</button>
            <div id="register-form" class="formation-section" style="display: none;">
                <div class="profile-row">
                    <label>이름:</label>
                    <input type="text" id="new-user-name" class="profile-input" placeholder="이름 입력">
                </div>
                <div class="profile-row">
                    <label>급수:</label>
                    <select id="new-user-grade" class="difficulty-select">
                        <option value="1">18급</option>
                        <option value="2">17급</option>
                        <option value="3">16급</option>
                        <option value="4">15급</option>
                        <option value="5">14급</option>
                        <option value="6">13급</option>
                        <option value="7">12급</option>
                        <option value="8">11급</option>
                        <option value="9">10급</option>
                        <option value="10">9급</option>
                        <option value="11">8급</option>
                        <option value="12">7급</option>
                        <option value="13">6급</option>
                        <option value="14">5급</option>
                        <option value="15">4급</option>
                        <option value="16">3급</option>
                        <option value="17">2급</option>
                        <option value="18">1급</option>
                        <option value="19">1단</option>
                        <option value="20">2단</option>
                        <option value="21">3단</option>
                        <option value="22">4단</option>
                        <option value="23">5단</option>
                        <option value="24">6단</option>
                        <option value="25">7단</option>
                        <option value="26">8단</option>
                        <option value="27">9단</option>
                    </select>
                </div>
                <div class="profile-row">
                    <label>선호 포진:</label>
                    <select id="new-user-formation" class="difficulty-select">
                        <option value="0">마상상마</option>
                        <option value="1">마상마상</option>
                        <option value="2">상마마상</option>
                        <option value="3">상마상마</option>
                    </select>
                </div>
                <div class="profile-row">
                    <label>AI 지연시간 (초):</label>
                    <input type="number" id="new-user-delay" class="difficulty-select" min="0" max="5" value="2"
                        step="0.5">
                </div>
                <div class="button-row">
                    <button id="add-user-btn" type="button" class="start-btn">등록</button>
                    <button id="cancel-register-btn" type="button" class="start-btn">취소</button>
                </div>
                <div class="info-line" id="user-limit-msg"></div>
            </div>
        </div>
    </div>

    <!-- Formation Selection Modal -->
    <div id="formation-modal" class="modal hidden">
        <div class="modal-content">
            <h2>대국 설정</h2>

            <!-- Player Side Selection -->
            <div class="formation-section">
                <h3>플레이어 진영</h3>
                <div class="side-options">
                    <button class="side-btn" data-side="cho">
                        <div class="side-name">초 (Cho)</div>
                        <div class="side-desc">선공</div>
                    </button>
                    <button class="side-btn" data-side="han">
                        <div class="side-name">한 (Han)</div>
                        <div class="side-desc">후공</div>
                    </button>
                </div>
            </div>

            <!-- AI Difficulty Selection -->
            <div class="formation-section">
                <h3>AI 난이도</h3>
                <div class="difficulty-options">
                    <select id="ai-difficulty" class="difficulty-select">
                        <option value="1">레벨1 (18~16급)</option>
                        <option value="2">레벨2 (15~13급)</option>
                        <option value="3">레벨3 (12~10급)</option>
                        <option value="4">레벨4 (9~7급)</option>
                        <option value="5">레벨5 (6~4급)</option>
                        <option value="6">레벨6 (3~1급)</option>
                        <option value="7">레벨7 (1~3단)</option>
                        <option value="8">레벨8 (4~6단)</option>
                        <option value="9">레벨9 (7~9단)</option>
                    </select>
                </div>
            </div>

            <!-- AI Delay Selection -->
            <div class="formation-section">
                <h3>AI 지연 시간 (초)</h3>
                <div class="difficulty-options">
                    <input type="number" id="ai-delay" class="difficulty-select" min="0" max="5" value="1" step="0.5">
                </div>
            </div>

            <!-- Formation Selection for Cho -->
            <div class="formation-section" id="cho-formation-section">
                <h3>초 포진</h3>
                <div class="formation-options">
                    <button class="formation-btn" data-side="cho" data-formation="0">
                        <div class="formation-name">마상상마</div>
                        <div class="formation-desc">마 상 상 마</div>
                    </button>
                    <button class="formation-btn" data-side="cho" data-formation="1">
                        <div class="formation-name">마상마상</div>
                        <div class="formation-desc">마 상 마 상</div>
                    </button>
                    <button class="formation-btn" data-side="cho" data-formation="2">
                        <div class="formation-name">상마마상</div>
                        <div class="formation-desc">상 마 마 상</div>
                    </button>
                    <button class="formation-btn" data-side="cho" data-formation="3">
                        <div class="formation-name">상마상마</div>
                        <div class="formation-desc">상 마 상 마</div>
                    </button>
                </div>
            </div>

            <!-- Formation Selection for Han -->
            <div class="formation-section" id="han-formation-section">
                <h3>한 포진</h3>
                <div class="formation-options">
                    <button class="formation-btn" data-side="han" data-formation="0">
                        <div class="formation-name">마상상마</div>
                        <div class="formation-desc">마 상 상 마</div>
                    </button>
                    <button class="formation-btn" data-side="han" data-formation="1">
                        <div class="formation-name">마상마상</div>
                        <div class="formation-desc">마 상 마 상</div>
                    </button>
                    <button class="formation-btn" data-side="han" data-formation="2">
                        <div class="formation-name">상마마상</div>
                        <div class="formation-desc">상 마 마 상</div>
                    </button>
                    <button class="formation-btn" data-side="han" data-formation="3">
                        <div class="formation-name">상마상마</div>
                        <div class="formation-desc">상 마 상 마</div>
                    </button>
                </div>
            </div>

            <button id="start-game-btn" class="start-btn" disabled>대국 시작</button>
        </div>
    </div>

    <div class="game-container">
        <div class="sidebar left">
            <div class="player-info" id="player-han">
                <div class="player-header">
                    <h2>한 (Han)</h2>
                    <span id="score-han" class="player-score">0.0</span>
                </div>
                <div class="captured-pieces" id="captured-han"></div>
            </div>
            <div class="player-info" id="player-cho">
                <div class="player-header">
                    <h2>초 (Cho)</h2>
                    <span id="score-cho" class="player-score">0.0</span>
                </div>
                <div class="captured-pieces" id="captured-cho"></div>
            </div>
        </div>

        <div class="board-container">
            <div id="board" class="board">
                <!-- Board rendered by JS -->
            </div>
        </div>

        <div class="sidebar right">
            <div class="controls">
                <div class="profile-summary">
                    <div id="profile-name-display">이름: -</div>
                    <div id="profile-grade-display">레벨: -</div>
                    <div id="profile-exp-display">EXP: 0 / -</div>
                    <div id="profile-record-display">전적: 0승 0패</div>
                </div>
                <div id="difficulty-display" class="info-line">난이도: -</div>
                <div id="turn-indicator">턴: <span id="current-turn">초</span></div>
                <div id="move-counter" class="info-line">0 / 200</div>
                <button id="pass-btn">한수 넘기기</button>
                <button id="undo-btn">한수 무르기</button>
                <button id="reset-btn">새 게임</button>
                <div id="status-message"></div>
            </div>
        </div>
    </div>

    <!-- User Edit Modal -->
    <div id="user-edit-modal" class="modal hidden">
        <div class="modal-content">
            <h2>사용자 정보 수정</h2>
            <div class="formation-section">
                <div class="profile-row">
                    <label>이름:</label>
                    <input type="text" id="edit-user-name" class="profile-input" disabled>
                </div>
                <div class="profile-row">
                    <label>급수:</label>
                    <select id="edit-user-grade" class="difficulty-select" disabled>
                        <option value="1">18급</option>
                        <option value="2">17급</option>
                        <option value="3">16급</option>
                        <option value="4">15급</option>
                        <option value="5">14급</option>
                        <option value="6">13급</option>
                        <option value="7">12급</option>
                        <option value="8">11급</option>
                        <option value="9">10급</option>
                        <option value="10">9급</option>
                        <option value="11">8급</option>
                        <option value="12">7급</option>
                        <option value="13">6급</option>
                        <option value="14">5급</option>
                        <option value="15">4급</option>
                        <option value="16">3급</option>
                        <option value="17">2급</option>
                        <option value="18">1급</option>
                        <option value="19">1단</option>
                        <option value="20">2단</option>
                        <option value="21">3단</option>
                        <option value="22">4단</option>
                        <option value="23">5단</option>
                        <option value="24">6단</option>
                        <option value="25">7단</option>
                        <option value="26">8단</option>
                        <option value="27">9단</option>
                    </select>
                </div>
                <div class="profile-row">
                    <label>선호 포진:</label>
                    <select id="edit-user-formation" class="difficulty-select">
                        <option value="0">마상상마</option>
                        <option value="1">마상마상</option>
                        <option value="2">상마마상</option>
                        <option value="3">상마상마</option>
                    </select>
                </div>
                <div class="profile-row">
                    <label>AI 지연시간 (초):</label>
                    <input type="number" id="edit-user-delay" class="difficulty-select" min="0" max="5" step="0.5">
                </div>
                <div class="button-row">
                    <button id="save-user-btn" type="button" class="start-btn">저장</button>
                    <button id="cancel-edit-btn" type="button" class="start-btn">취소</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Post-Game Result Modal -->
    <div id="result-modal" class="modal hidden">
        <div class="modal-content">
            <h2 id="result-title">게임 결과</h2>
            <div class="formation-section">
                <div class="result-display">
                    <div id="result-outcome" class="result-outcome"></div>
                    <div id="result-xp" class="result-xp"></div>
                    <div id="result-rank" class="result-rank"></div>
                </div>
                <div class="button-row">
                    <button id="next-game-btn" type="button" class="start-btn">다음 게임</button>
                    <button id="exit-game-btn" type="button" class="start-btn">종료</button>
                </div>
            </div>
        </div>
    </div>

    <script src="user-manager.js"></script>
    <script src="sounds.js"></script>
    <script src="script.js"></script>
    <script src="ai.js"></script>
</body>

</html>